<!-- Header -->
<div class="flex flex-col gap-2">
  <h2 class="text-[#111317] dark:text-white text-3xl font-bold tracking-tight">Crie sua conta</h2>
  <p class="text-[#646e87] dark:text-gray-400 text-base font-normal">
    Preencha seus dados para começar
  </p>
</div>

<!-- Form -->
<form [formGroup]="registerForm" (ngSubmit)="onSubmit()" class="flex flex-col gap-5">
  <!-- Name Field -->
  <label class="flex flex-col gap-2">
    <span class="text-[#111317] dark:text-gray-200 text-sm font-bold leading-normal ml-1"
      >Nome Completo</span
    >
    <div class="relative">
      <input
        formControlName="name"
        type="text"
        placeholder="Seu nome completo"
        class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-xl text-[#111317] dark:text-white focus:outline-0 focus:ring-2 focus:ring-[#3f70e4]/20 border border-[#dcdfe5] dark:border-gray-700 bg-white dark:bg-[#1a202e] focus:border-[#3f70e4] h-12 placeholder:text-[#646e87] px-4 pr-12 text-base font-normal leading-normal transition-all"
        [class.border-red-500]="
          registerForm.get('name')?.invalid && registerForm.get('name')?.touched
        "
      />
      <span
        class="material-symbols-outlined absolute right-4 top-3 text-[#646e87] pointer-events-none"
        >person</span
      >
    </div>
    @if (registerForm.get('name')?.invalid && registerForm.get('name')?.touched) {
      <span class="text-red-500 text-xs ml-1">
        @if (registerForm.get('name')?.hasError('required')) {
          Nome é obrigatório
        } @else if (registerForm.get('name')?.hasError('minlength')) {
          Nome deve ter no mínimo 3 caracteres
        }
      </span>
    }
  </label>

  <!-- Email Field -->
  <label class="flex flex-col gap-2">
    <span class="text-[#111317] dark:text-gray-200 text-sm font-bold leading-normal ml-1"
      >Email</span
    >
    <div class="relative">
      <input
        formControlName="email"
        type="email"
        placeholder="estudante@universidade.edu"
        class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-xl text-[#111317] dark:text-white focus:outline-0 focus:ring-2 focus:ring-[#3f70e4]/20 border border-[#dcdfe5] dark:border-gray-700 bg-white dark:bg-[#1a202e] focus:border-[#3f70e4] h-12 placeholder:text-[#646e87] px-4 pr-12 text-base font-normal leading-normal transition-all"
        [class.border-red-500]="
          registerForm.get('email')?.invalid && registerForm.get('email')?.touched
        "
      />
      <span
        class="material-symbols-outlined absolute right-4 top-3 text-[#646e87] pointer-events-none"
        >mail</span
      >
    </div>
    @if (registerForm.get('email')?.invalid && registerForm.get('email')?.touched) {
      <span class="text-red-500 text-xs ml-1">
        @if (registerForm.get('email')?.hasError('required')) {
          Email é obrigatório
        } @else if (registerForm.get('email')?.hasError('email')) {
          Email inválido
        }
      </span>
    }
  </label>

  <!-- Password Field -->
  <label class="flex flex-col gap-2">
    <span class="text-[#111317] dark:text-gray-200 text-sm font-bold leading-normal ml-1"
      >Senha</span
    >
    <div class="relative">
      <input
        formControlName="password"
        [type]="showPassword() ? 'text' : 'password'"
        placeholder="Crie uma senha forte"
        class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-xl text-[#111317] dark:text-white focus:outline-0 focus:ring-2 focus:ring-[#3f70e4]/20 border border-[#dcdfe5] dark:border-gray-700 bg-white dark:bg-[#1a202e] focus:border-[#3f70e4] h-12 placeholder:text-[#646e87] px-4 pr-12 text-base font-normal leading-normal transition-all"
        [class.border-red-500]="
          registerForm.get('password')?.invalid && registerForm.get('password')?.touched
        "
      />
      <button
        type="button"
        (click)="togglePassword()"
        class="absolute right-4 top-3 text-[#646e87] hover:text-[#3f70e4] transition-colors"
      >
        <span class="material-symbols-outlined">{{
          showPassword() ? 'visibility' : 'visibility_off'
        }}</span>
      </button>
    </div>
    @if (registerForm.get('password')?.invalid && registerForm.get('password')?.touched) {
      <span class="text-red-500 text-xs ml-1">
        @if (registerForm.get('password')?.hasError('required')) {
          Senha é obrigatória
        } @else if (registerForm.get('password')?.hasError('minlength')) {
          Senha deve ter no mínimo 6 caracteres
        }
      </span>
    }
  </label>

  <!-- Confirm Password Field -->
  <label class="flex flex-col gap-2">
    <span class="text-[#111317] dark:text-gray-200 text-sm font-bold leading-normal ml-1"
      >Confirmar Senha</span
    >
    <div class="relative">
      <input
        formControlName="confirmPassword"
        [type]="showConfirmPassword() ? 'text' : 'password'"
        placeholder="Repita sua senha"
        class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-xl text-[#111317] dark:text-white focus:outline-0 focus:ring-2 focus:ring-[#3f70e4]/20 border border-[#dcdfe5] dark:border-gray-700 bg-white dark:bg-[#1a202e] focus:border-[#3f70e4] h-12 placeholder:text-[#646e87] px-4 pr-12 text-base font-normal leading-normal transition-all"
        [class.border-red-500]="
          registerForm.get('confirmPassword')?.invalid &&
          registerForm.get('confirmPassword')?.touched
        "
      />
      <button
        type="button"
        (click)="toggleConfirmPassword()"
        class="absolute right-4 top-3 text-[#646e87] hover:text-[#3f70e4] transition-colors"
      >
        <span class="material-symbols-outlined">{{
          showConfirmPassword() ? 'visibility' : 'visibility_off'
        }}</span>
      </button>
    </div>
    @if (
      registerForm.get('confirmPassword')?.invalid && registerForm.get('confirmPassword')?.touched
    ) {
      <span class="text-red-500 text-xs ml-1">
        @if (registerForm.get('confirmPassword')?.hasError('required')) {
          Confirmação de senha é obrigatória
        } @else if (registerForm.get('confirmPassword')?.hasError('passwordMismatch')) {
          As senhas não coincidem
        }
      </span>
    }
  </label>

  <!-- Error Message -->
  @if (errorMessage()) {
    <div class="bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl text-sm">
      {{ errorMessage() }}
    </div>
  }

  <!-- Submit Button -->
  <button
    type="submit"
    [disabled]="registerForm.invalid || isLoading()"
    class="mt-2 flex w-full cursor-pointer items-center justify-center overflow-hidden rounded-xl h-12 px-5 bg-[#3f70e4] hover:bg-[#3f70e4]/90 transition-colors text-white text-base font-bold leading-normal tracking-[0.015em] shadow-lg shadow-[#3f70e4]/20 disabled:opacity-50 disabled:cursor-not-allowed"
  >
    @if (isLoading()) {
      <span class="flex items-center gap-2">
        <svg
          class="animate-spin h-5 w-5 text-white"
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
        >
          <circle
            class="opacity-25"
            cx="12"
            cy="12"
            r="10"
            stroke="currentColor"
            stroke-width="4"
          ></circle>
          <path
            class="opacity-75"
            fill="currentColor"
            d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
          ></path>
        </svg>
        Criando conta...
      </span>
    } @else {
      <span class="truncate">Criar Conta</span>
    }
  </button>
</form>

<!-- Divider -->
<div class="relative flex py-1 items-center">
  <div class="flex-grow border-t border-[#dcdfe5] dark:border-gray-700"></div>
  <span class="flex-shrink-0 mx-4 text-[#646e87] dark:text-gray-500 text-sm font-medium">ou</span>
  <div class="flex-grow border-t border-[#dcdfe5] dark:border-gray-700"></div>
</div>

<!-- Google Sign Up -->
<button
  type="button"
  (click)="signUpWithGoogle()"
  class="flex w-full cursor-pointer items-center justify-center gap-3 overflow-hidden rounded-xl h-12 px-5 bg-white dark:bg-[#1a202e] border border-[#dcdfe5] dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors text-[#111317] dark:text-white text-base font-bold leading-normal tracking-[0.015em]"
>
  <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <path
      d="M23.766 12.2764C23.766 11.4607 23.6999 10.6406 23.5588 9.83807H12.24V14.4591H18.7217C18.4528 15.9494 17.5885 17.2678 16.323 18.1056V21.1039H20.19C22.4608 19.0139 23.766 15.9274 23.766 12.2764Z"
      fill="#4285F4"
    />
    <path
      d="M12.24 24.0008C15.4765 24.0008 18.2058 22.9382 20.1945 21.1039L16.3275 18.1055C15.2517 18.8375 13.8627 19.252 12.2445 19.252C9.11388 19.252 6.45946 17.1399 5.50705 14.3003H1.5166V17.3912C3.55371 21.4434 7.7029 24.0008 12.24 24.0008Z"
      fill="#34A853"
    />
    <path
      d="M5.50253 14.3003C5.00236 12.8199 5.00236 11.1799 5.50253 9.69951V6.60861H1.5166C-0.18551 10.0056 -0.18551 13.9945 1.5166 17.3915L5.50253 14.3003Z"
      fill="#FBBC05"
    />
    <path
      d="M12.24 4.74966C13.9509 4.7232 15.6044 5.36697 16.8434 6.54867L20.2695 3.12262C18.1001 1.0855 15.2208 -0.0344664 12.24 0.000808666C7.7029 0.000808666 3.55371 2.55822 1.5166 6.60861L5.50253 9.69951C6.45064 6.86154 9.10947 4.74966 12.24 4.74966Z"
      fill="#EA4335"
    />
  </svg>
  <span class="truncate">Continuar com Google</span>
</button>

<!-- Login Link -->
<div class="flex justify-center mt-4">
  <p class="text-[#646e87] dark:text-gray-400 text-sm font-medium">
    Já tem uma conta?
    <a routerLink="/auth/login" class="text-[#3f70e4] font-bold hover:underline ml-1">Entrar</a>
  </p>
</div>
